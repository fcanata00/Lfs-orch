#############################################
# PORG - Package Orchestrator Configuration #
# Versão: Final Integrada (LFS/BLFS Ready)  #
#############################################

# Diretórios principais
WORKDIR="/var/tmp/porg"
CACHE_DIR="${WORKDIR}/cache"
LOG_DIR="${WORKDIR}/logs"
PATCH_DIR="${WORKDIR}/patches"
DESTDIR_BASE="${WORKDIR}/destdir"
PKG_OUTPUT_DIR="${WORKDIR}/packages"
PORTS_DIR="/usr/ports"
MODULES_DIR="/usr/lib/porg"
CONF_FILE="/etc/porg/porg.conf"
DB_DIR="/var/lib/porg"
DB_BACKUP_DIR="${DB_DIR}/backups"
HOOK_DIR="/etc/porg/hooks"
LFS="/mnt/lfs"

# Parâmetros de build
USE_CHROOT=true
CHROOT_METHOD="bwrap"
CHROOT_DIR="${LFS}/chroot"
MOUNT_BIND_HOST=true
COPY_RESOLV_CONF=true
JOBS="$(nproc 2>/dev/null || echo 1)"
PKG_FORMAT="tar.zst"
STRIP_BINARIES=true
USE_FAKEROOT=true
ALLOW_BOOTSTRAP=true

# Repositório de Metafiles
GIT_REPO="https://github.com/seuusuario/porg-ports.git"
GIT_BRANCH="main"
SYNC_ON_START=true
AUTO_UPDATE_PORTS=true

# Logs e registro
LOG_COLOR=true
LOG_TIMESTAMP=true
LOG_LEVEL="INFO"
SHOW_LOADAVG=true
SHOW_CPU_MEM=true
LOG_FILE_MAXSIZE="10M"
CLEAN_OLD_LOGS_DAYS=10
LOG_UI_STYLE="fancy"

# Banco de dados de pacotes
DB_FILE="${DB_DIR}/porg.db"
DB_BACKUP_ON_CHANGE=true
MANIFEST_CHECKSUM=true
PKG_MANIFEST_EXT=".manifest"

# Dependências e resolução
DEPS_PY="/usr/lib/porg/porg_deps.py"
AUTO_DEP_CLEAN=true
AUTO_REVDEP_REBUILD=true
RESOLVE_CACHE="${WORKDIR}/resolve-cache"
RESOLVE_PARALLEL=true

# Upgrade e sincronização
ALLOW_UPGRADE=true
BACKUP_BEFORE_UPGRADE=true
CONTINUE_ON_FAIL=true
UPGRADE_RESUME_ON_REBOOT=true
ALLOW_DOWNGRADE=false

# Remoção
ALLOW_FORCE_REMOVE=true
AUTO_HOOK_REMOVE=true
REMOVE_ORPHANS_AFTER_FORCE=true

# Auditoria
ENABLE_AUDIT=true
AUTO_FIX_PROBLEMS=true
AUDIT_INTERVAL=7
AUDIT_VULN_SOURCES="https://cve.mitre.org,https://security.archlinux.org"
AUDIT_SEVERITY_THRESHOLD="medium"
LIBCHECK_TOOLS="ldd scanelf readelf"

# Segurança
GPG_VERIFY=true
CHECKSUM_VERIFY=true
STRICT_GPG=false
MIRRORS=("https://ftp.gnu.org/gnu" "https://mirrors.edge.kernel.org")

# Extra
QUIET_MODE=false
DEBUG_MODE=false
DRY_RUN=false
SHOW_PROGRESS=true
SHOW_TIMING=true
PARALLEL_BUILDS=true
PARALLEL_FETCH=true

# Módulos principais
PORG_LOGGER="${MODULES_DIR}/porg_logger.sh"
PORG_DB="${MODULES_DIR}/porg_db.sh"
PORG_DEPS="${MODULES_DIR}/porg_deps.py"
PORG_REMOVE="${MODULES_DIR}/porg_remove.sh"
PORG_RESOLVE="${MODULES_DIR}/porg_resolve.sh"
PORG_UPGRADE="${MODULES_DIR}/porg_upgrade.sh"
PORG_AUDIT="${MODULES_DIR}/porg_audit.sh"
PORG_BUILDER="${MODULES_DIR}/porg_builder.sh"
PORG_BOOTSTRAP="${MODULES_DIR}/porg_bootstrap.sh"

# Compatibilidade e variáveis herdadas
PKG_BACKUP_DIR="${PKG_OUTPUT_DIR}/backup"
TMP_DIR="${WORKDIR}/tmp"
SRC_DIR="${WORKDIR}/sources"
SRC_ARCHIVE_DIR="${CACHE_DIR}"
SRC_EXTRACT_DIR="${WORKDIR}/src"
HOOK_LOG_DIR="${LOG_DIR}/hooks"

# Definições de inicialização
ON_INIT_CREATE_DIRS=(
  "${WORKDIR}"
  "${CACHE_DIR}"
  "${LOG_DIR}"
  "${PATCH_DIR}"
  "${DESTDIR_BASE}"
  "${DB_DIR}"
  "${DB_BACKUP_DIR}"
  "${HOOK_DIR}"
  "${PKG_OUTPUT_DIR}"
)SHOW_CPU_MEM=true                       # Show CPU/mem usage in real-time

# ────────────────────────────────────────────────────────────────
# 🧪  Audit and Security
# ────────────────────────────────────────────────────────────────
ENABLE_AUDIT=true                       # Enable system audit mode
AUTO_FIX_PROBLEMS=true                  # Automatically fix broken libs/links
AUDIT_INTERVAL="weekly"
AUDIT_VULN_SOURCES=(
  "https://cve.circl.lu/api/last"
  "https://security-tracker.debian.org/tracker/source-package"
)
LIBCHECK_TOOLS=("ldd" "scanelf" "readelf")
AUDIT_SEVERITY_THRESHOLD="medium"       # low|medium|high

# ────────────────────────────────────────────────────────────────
# 📦  Packaging / Compression
# ────────────────────────────────────────────────────────────────
PKG_FORMAT="tar.zst"                    # tar.xz | tar.zst | tar.gz
PKG_COMPRESS_LEVEL=19
PKG_OUTPUT_DIR="/var/cache/porg/packages"

# ────────────────────────────────────────────────────────────────
# 🔒  Security / Sandbox
# ────────────────────────────────────────────────────────────────
BWRAP_BIN="/usr/bin/bwrap"
CHROOT_ISOLATE_NET=false                # Disable network inside chroot
CHROOT_MOUNT_DEV=true                   # Mount /dev inside chroot
CHROOT_MOUNT_PROC=true                  # Mount /proc inside chroot
CHROOT_MOUNT_SYS=true                   # Mount /sys inside chroot

# ────────────────────────────────────────────────────────────────
# 🌍  Network and Mirrors
# ────────────────────────────────────────────────────────────────
NET_RETRIES=3
NET_TIMEOUT=60
DOWNLOAD_DIR="/var/cache/porg/sources"
MIRRORS=(
  "https://ftp.gnu.org/gnu"
  "https://mirror.example.org"
)
GPG_VERIFY=true
CHECKSUM_VERIFY=true

# ────────────────────────────────────────────────────────────────
# 💾  Database and Manifest
# ────────────────────────────────────────────────────────────────
MANIFEST_CHECKSUM=true
DB_BACKUP_ON_CHANGE=true
DB_BACKUP_DIR="/var/backups/porg/db"

# ────────────────────────────────────────────────────────────────
# 🧠  Advanced / Developer
# ────────────────────────────────────────────────────────────────
DEBUG_MODE=false
SHOW_TIMING=true
SHOW_PROGRESS=true
FORCE_REBUILD=false
VERBOSE_PARSER=false

# ────────────────────────────────────────────────────────────────
# 🧩  Integration with other modules
# ────────────────────────────────────────────────────────────────
LOGGER_MODULE="/usr/lib/porg/porg_logger.sh"
DB_MODULE="/usr/lib/porg/porg_db.sh"
REMOVE_MODULE="/usr/lib/porg/porg_remove.sh"
RESOLVE_MODULE="/usr/lib/porg/resolve.sh"
UPGRADE_MODULE="/usr/lib/porg/porg_upgrade.sh"
AUDIT_MODULE="/usr/lib/porg/porg_audit.sh"

# ────────────────────────────────────────────────────────────────
# 🧩  Miscellaneous
# ────────────────────────────────────────────────────────────────
TMP_DIR="/tmp/porg"
CACHE_DIR="/var/cache/porg"
LOCK_DIR="/run/lock/porg"
SHELL="/bin/bash"

# End of file
